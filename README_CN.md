# 人流量监控平台

## 介绍

我们使用YOLO v3模型去对人群中人的数量进行计数

在边缘端运行识别程序，我们将识别的人数量和实时处理过后的视频发送到云端，在云端进行视频的播放和人数的显示，当人数超过管理员设定的阈值，显示人数的数字将会被放大，并且显示为红色。此外，我们还记录的历史最高人数、一小时内最高人数、以及采用灰度模型预测未来2分钟内的人数。我们还提供了图表展示，显示过去10分钟内的人流量情况。

平台的整体架构为：在边缘端有两个进程，一个是输入视频文件或者直接摄像头输入，通过yolo模型按视频帧识别出人，再对人进行计数，最后在另一进程中将视频帧输入到pipe，人数通过post方法提交到云端，ffmpeg在pipe的另一端读取视频帧，将每四个视频帧合称为一组视频，推动到nginx服务器上的rtmp application，再通过nginx服务器的转发，将视频推送到云端的播放器。在云端，我们有一套用户系统，用户可以注册并登录，之后进入管理后台，可以到各种监控数据。我们在云端的后台有一个MariaDB数据库，用来存放一些相关数据，如历史最高分数、当前人数、历史所有数据等，通过controller里的一些方法进行数据处理最终展示给页面。

## 使用

### 需要的依赖

#### 云端
##### jdk 1.8
##### tomcat 8.0
##### mariadb-java-client-2.2.6.jar

#### 边缘端
##### python 3.6
##### torch 0.4
##### cuda 9.0(not necessary)
##### opencv (latest version)
##### some other python libs can see in import

#### 其他
##### ffmpeg
##### nginx-rtmp
##### MariaDB DataBase
